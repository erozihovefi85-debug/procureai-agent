# ✅ MongoDB Network Service User 部署检查清单

## 📋 部署前准备

### 环境检查
- [ ] Node.js 18.0+ 已安装
- [ ] MongoDB 6.0+ 安装包已下载
- [ ] 服务器公网 IP 已获取
- [ ] 域名已配置（如果有）
- [ ] 防火墙已准备好配置

---

## 🔧 MongoDB 配置

### 1️⃣ 运行配置脚本
- [ ] 已运行 `setup-mongodb-network-user.ps1`
- [ ] 已记录服务账户凭据：
  - Username: `_____________`
  - Password: `_____________`
- [ ] 已创建数据目录
- [ ] 已创建日志目录

### 2️⃣ 安装 MongoDB
- [ ] 已下载 MongoDB 安装包
- [ ] 已运行安装程序
- [ ] 已选择 "Run service as Network Service user"
- [ ] 已配置数据目录路径
- [ ] 已配置日志目录路径
- [ ] 安装完成

### 3️⃣ 配置安全性
- [ ] 已创建 MongoDB 超级管理员账户
- [ ] 已记录管理员凭据：
  - Username: `_____________`
  - Password: `_____________`
- [ ] 已配置 MongoDB 启用认证
- [ ] 已修改 `mongod.cfg` 配置文件
- [ ] 已设置适当的缓存大小
- [ ] 已配置连接数限制

---

## 🔥 安全配置

### 防火墙配置
- [ ] 已添加 MongoDB 端口 27017 防火墙规则
- [ ] 已添加后端端口 3001 防火墙规则
- [ ] 已添加前端端口 5173 防火墙规则
- [ ] （可选）已限制访问 IP

### 网络安全
- [ ] 已决定数据库访问方式：
  - [ ] 仅本地访问（推荐）
  - [ ] 允许外部访问
- [ ] 已配置 MongoDB `bindIp` 设置
- [ ] （可选）已配置 SSL/TLS
- [ ] （可选）已配置反向代理（Nginx）

---

## 🚀 应用配置

### 后端配置
- [ ] 已复制 `backend/.env.production` 到 `backend/.env`
- [ ] 已修改 MongoDB 连接字符串
- [ ] 已更新 JWT_SECRET 为强密钥
- [ ] 已配置 CORS_ORIGIN
- [ ] 已更新 Dify API Keys（如果需要）
- [ ] 已设置正确的 NODE_ENV

### 前端配置
- [ ] 已更新 `.env.local` 中的 API URL
- [ ] 已配置为生产环境域名或公网 IP
- [ ] 已移除开发环境的 localhost

---

## 🌍 对外访问配置

### 域名配置
- [ ] （如果有）已配置 A 记录
- [ ] （如果有）已配置 DNS 解析
- [ ] （如果有）已配置反向代理

### 服务器访问
- [ ] 已获取服务器公网 IP
- [ ] 已验证端口转发规则
- [ ] 已测试外部访问

---

## 🔄 服务启动

### 1️⃣ 启动 MongoDB
- [ ] 已运行：`net start MongoDB`
- [ ] 已验证服务状态：`RUNNING`
- [ ] 已检查日志文件
- [ ] 无错误信息

### 2️⃣ 测试数据库连接
- [ ] 已使用 MongoDB Shell 测试连接
- [ ] 已验证认证功能
- [ ] 已测试基本操作

### 3️⃣ 启动后端
- [ ] 已运行 `start-production.bat` 选择选项 2
- [ ] 已选择 Production 模式
- [ ] 后端启动成功
- [ ] 无数据库连接错误
- [ ] 已显示 "Server running at http://localhost:3001"

### 4️⃣ 启动前端
- [ ] 前端启动成功
- [ ] 已显示 "Local: http://localhost:5173/"
- [ ] 无编译错误

### 5️⃣ 初始化数据库
- [ ] 已运行 `npm run seed`
- [ ] 已创建管理员账户
- [ ] 已记录管理员凭据：
  - Email: `admin@procureai.com`
  - Password: `admin123`

---

## 🧪 功能测试

### 本地测试
- [ ] 本地访问后端 API：http://localhost:3001/api
- [ ] 本地访问前端：http://localhost:5173
- [ ] 已测试随意采购功能
- [ ] 已测试规范采购功能
- [ ] 已测试用户注册/登录
- [ ] 已测试图片找同款
- [ ] 所有功能正常

### 外部测试
- [ ] 外部访问后端 API：http://YOUR_IP:3001/api
- [ ] 外部访问前端：http://YOUR_IP:5173
- [ ] 已测试外部注册/登录
- [ ] 已测试外部聊天功能
- [ ] 所有外部功能正常

---

## 📊 监控配置

### 日志配置
- [ ] MongoDB 日志已配置
- [ ] 已设置日志轮转
- [ ] 日志目录可访问
- [ ] 已设置监控日志的脚本

### 备份配置
- [ ] 已创建备份目录
- [ ] 已创建备份脚本
- [ ] 已设置计划任务
- [ ] 已测试备份功能

---

## 🔒 安全加固

### 密码安全
- [ ] 已更改默认管理员密码
- [ ] 已更改 MongoDB 超级管理员密码
- [ ] 已更改服务账户密码
- [ ] 所有密码都是强密码

### 网络安全
- [ ] 已使用 HTTPS（如果有域名）
- [ ] 已配置反向代理
- [ ] 已配置 SSL 证书
- [ ] 数据库已限制为仅本地访问（推荐）

### 权限安全
- [ ] 已检查目录权限
- [ ] 已设置适当的访问控制
- [ ] 已配置最小权限原则

---

## 📝 文档记录

### 配置记录
- [ ] 已保存所有配置文件
- [ ] 已记录所有凭据（安全存储）
- [ ] 已记录服务器信息
- [ ] 已创建恢复文档

### 访问信息
**服务器信息：**
- 公网 IP: `_____________`
- 域名: `_____________`
- SSH/RDP 凭据: `_____________`

**MongoDB 信息：**
- 服务账户: `_____________`
- 管理员账户: `_____________`
- 连接字符串: `_____________`

**应用访问：**
- 前端 URL: `_____________`
- 后端 API: `_____________`
- 管理员账号: `admin@procureai.com`
- 管理员密码: `admin123`（首次登录后更改）

---

## 🎯 最终检查

### 生产环境就绪
- [ ] 所有服务正常运行
- [ ] 所有安全配置完成
- [ ] 所有备份策略已实施
- [ ] 所有监控已配置
- [ ] 外部访问测试成功
- [ ] 性能测试通过

### 部署完成
- [ ] 已将部署信息通知相关人员
- [ ] 已准备应急预案
- [ ] 已设置故障监控
- [ ] 已准备回滚计划

---

## 🆘 应急联系方式

- 服务器管理员: `_____________`
- 开发负责人: `_____________`
- MongoDB 管理员: `_____________`
- 网络管理员: `_____________`

---

## 📅 维护计划

### 日常维护
- [ ] 每日检查日志
- [ ] 每日检查服务状态
- [ ] 每日检查备份

### 定期维护
- [ ] 每周检查磁盘空间
- [ ] 每周检查性能指标
- [ ] 每月更新系统补丁
- [ ] 每月更新依赖包

### 备份计划
- [ ] 数据库备份频率：`______`
- [ ] 配置文件备份频率：`______`
- [ ] 备份保留天数：`______`

---

## ✅ 签署

部署人员: `_____________`
部署日期: `____/____/____`
审核人员: `_____________`
审核日期: `____/____/____`

---
